(()=>{"use strict";const e={};let t=!0,o=(e=500)=>{let o=document.querySelector("body");if(t){let n=document.querySelectorAll("[data-lp]");setTimeout((()=>{for(let e=0;e<n.length;e++){n[e].style.paddingRight="0px"}o.style.paddingRight="0px",document.documentElement.classList.remove("lock")}),e),t=!1,setTimeout((function(){t=!0}),e)}},n=(e=500)=>{let o=document.querySelector("body");if(t){let n=document.querySelectorAll("[data-lp]");for(let e=0;e<n.length;e++){n[e].style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px"}o.style.paddingRight=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px",document.documentElement.classList.add("lock"),t=!1,setTimeout((function(){t=!0}),e)}};let i={getErrors(e){let t=0,o=e.querySelectorAll("*[data-required]");return o.length&&o.forEach((e=>{null===e.offsetParent&&"SELECT"!==e.tagName||e.disabled||(t+=this.validateInput(e))})),t},validateInput(e){let t=0;return"email"===e.dataset.required?(e.value=e.value.replace(" ",""),this.emailTest(e)?(this.addError(e),t++):this.removeError(e)):("checkbox"!==e.type||e.checked)&&e.value.trim()?this.removeError(e):(this.addError(e),t++),t},addError(e){e.classList.add("_form-error"),e.parentElement.classList.add("_form-error");let t=e.parentElement.querySelector(".form__error");t&&e.parentElement.removeChild(t),e.dataset.error&&e.parentElement.insertAdjacentHTML("beforeend",`<div class="form__error">${e.dataset.error}</div>`)},removeError(e){e.classList.remove("_form-error"),e.parentElement.classList.remove("_form-error"),e.parentElement.querySelector(".form__error")&&e.parentElement.removeChild(e.parentElement.querySelector(".form__error"))},formClean(t){t.reset(),setTimeout((()=>{let o=t.querySelectorAll("input,textarea");for(let e=0;e<o.length;e++){const t=o[e];t.parentElement.classList.remove("_form-focus"),t.classList.remove("_form-focus"),i.removeError(t)}let n=t.querySelectorAll(".checkbox__input");if(n.length>0)for(let e=0;e<n.length;e++){n[e].checked=!1}if(e.select){let o=t.querySelectorAll(".select");if(o.length)for(let t=0;t<o.length;t++){const n=o[t].querySelector("select");e.select.selectBuild(n)}}}),0)},emailTest:e=>!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)};let a=!1;setTimeout((()=>{if(a){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0),document.addEventListener("DOMContentLoaded",(function(){const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",document.body.appendChild(e);const t=document.createElement("div");e.appendChild(t);const o=e.offsetWidth-t.offsetWidth;e.parentNode.removeChild(e),document.documentElement.style.setProperty("--scrollbar-width",o+"px")})),window.onload=function(){document.body.classList.add("loaded_hiding"),window.setTimeout((function(){document.body.classList.add("loaded"),document.body.classList.remove("loaded_hiding")}),500)};const s="8c8e1a50-6322-4135-8875-5d40a5420d86",r="https://kinopoiskapiunofficial.tech/api/v2.2/films/top?type=TOP_100_POPULAR_FILMS&page=",c="https://kinopoiskapiunofficial.tech/api/v2.2/films?order=NUM_VOTE&type=FILM&ratingFrom=5&ratingTo=10&yearFrom=1960&yearTo=2023&page=",l="https://kinopoiskapiunofficial.tech/api/v2.2/films?order=NUM_VOTE&type=TV_SERIES&ratingFrom=5&ratingTo=10&yearFrom=1960&yearTo=2023&page=",d="https://kinopoiskapiunofficial.tech/api/v2.2/films?order=NUM_VOTE&type=MINI_SERIES&ratingFrom=6&ratingTo=10&yearFrom=1960&yearTo=2023&page=",m="https://kinopoiskapiunofficial.tech/api/v2.2/films?order=NUM_VOTE&type=TV_SHOW&ratingFrom=5&ratingTo=10&yearFrom=1960&yearTo=2023&page=",u="https://kinopoiskapiunofficial.tech/api/v2.2/films/top?type=TOP_250_BEST_FILMS&page=",p="https://kinopoiskapiunofficial.tech/api/v2.2/films/",v=document.querySelectorAll(".pagination__item"),f=document.querySelectorAll(".menu__link"),_=(document.querySelector("._filter"),document.querySelector("._films")),h=document.querySelector("._serials"),y=document.querySelector("._mini-serials"),g=document.querySelector("._tv-show"),E=document.querySelector("._top-250"),L=document.querySelector(".header__logo");async function w(e){const t=await fetch(e,{headers:{"Content-Type":"application/json","X-API-KEY":s}});$(await t.json())}async function k(e){const t=await fetch(e,{headers:{"Content-Type":"application/json","X-API-KEY":s}});I(await t.json())}async function S(e){const t=await fetch(e,{headers:{"Content-Type":"application/json","X-API-KEY":s}});I(await t.json())}async function A(e){const t=await fetch(e,{headers:{"Content-Type":"application/json","X-API-KEY":s}});I(await t.json())}async function T(e){const t=await fetch(e,{headers:{"Content-Type":"application/json","X-API-KEY":s}});I(await t.json())}async function b(e){const t=await fetch(e,{headers:{"Content-Type":"application/json","X-API-KEY":s}});$(await t.json())}function q(e){return e>=7?"green":e>5?"orange":"red"}function $(e){const t=document.querySelector(".movies");document.querySelector(".movies").innerHTML="",e.films.forEach((e=>{const o=document.createElement("div");o.classList.add("movie"),o.innerHTML=`\n\t\t<div class="movie__cover">\n\t\t\t<div class="movie__cover-img -ibg">\n\t\t\t\t<img src="${e.posterUrlPreview}" alt="${e.nameRu}">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="movie__info">\n\t\t\t<div class="movie__title">${e.nameRu}</div>\n\t\t\t<div class="movie__category">${e.genres.map((e=>` ${e.genre}`))}</div>\n\t\t\t${e.rating&&`\n\t\t\t<div class="movie__average movie__average_${q(e.rating)}">${e.rating}</div>`}\n\t\t</div>\n\t\t\t\t`,o.addEventListener("click",(()=>R(e.filmId))),t.appendChild(o)}))}function I(e){const t=document.querySelector(".movies");document.querySelector(".pagination__list");document.querySelector(".movies").innerHTML="",e.items.forEach((e=>{const o=document.createElement("div");o.classList.add("movie"),o.innerHTML=`\n\t\t<div class="movie__cover">\n\t\t\t<div class="movie__cover-img -ibg">\n\t\t\t\t<img src="${e.posterUrlPreview}" alt="${e.nameRu}">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="movie__info">\n\t\t\t<div class="movie__title">${e.nameRu}</div>\n\t\t\t<div class="movie__category">${e.genres.map((e=>` ${e.genre}`))}</div>\n\t\t\t${e.ratingKinopoisk&&`\n\t\t\t<div class="movie__average movie__average_${q(e.ratingKinopoisk)}">${e.ratingKinopoisk}</div>`}\n\t\t</div>\n\t\t\t\t`,o.addEventListener("click",(()=>R(e.kinopoiskId))),t.appendChild(o)}))}v.forEach((e=>{e.addEventListener("click",(()=>{v.forEach((e=>{e.classList.remove("_active")})),e.classList.add("_active");const t=e.textContent;_.classList.contains("_active")?k(c+t):h.classList.contains("_active")?S(l+t):y.classList.contains("_active")?A(d+t):g.classList.contains("_active")?T(m+t):E.classList.contains("_active")?b(u+t):w(r+t),window.scrollTo({top:0,behavior:"smooth"})}))})),f.forEach((e=>{e.addEventListener("click",(()=>{f.forEach((e=>{e.classList.remove("_active")})),e.classList.add("_active")}))})),_.addEventListener("click",(()=>{k(c)})),h.addEventListener("click",(()=>{S(l)})),y.addEventListener("click",(()=>{A(d)})),g.addEventListener("click",(()=>{T(m)})),E.addEventListener("click",(()=>{b(u)})),L.addEventListener("click",(()=>{w(r)})),w(r),f.forEach((e=>{e.addEventListener("click",(()=>{if(document.querySelector("html").classList.remove("lock","menu-open"),v.forEach((e=>{e.classList.remove("_active")})),e===E)for(let e=5;e<v.length;e++)v[e].style.display="block";else for(let e=5;e<v.length;e++)v[e].style.display="none";v[0].classList.add("_active")}))}));const P=document.querySelector("form"),C=document.querySelector(".header__search");P.addEventListener("submit",(e=>{e.preventDefault();const t=`https://kinopoiskapiunofficial.tech/api/v2.1/films/search-by-keyword?keyword=${C.value}`;C.value&&(w(t),C.value="")}));const j=document.querySelector(".modal");async function R(e){const t=await fetch(p+e,{headers:{"Content-Type":"application/json","X-API-KEY":s}}),o=await t.json();j.classList.add("modal--show"),document.body.classList.add("stop-scrolling");const n=o.webUrl.replace("kino","ss");j.innerHTML=`\n    <div class="modal__card">\n      <img class="modal__movie-backdrop" src="${o.posterUrlPreview}" alt="">\n      <h2>\n        <span class="modal__movie-title">${o.nameRu}</span>\n        <span class="modal__movie-release-year"> - ${o.year}</span>\n      </h2>\n      <ul class="modal__movie-info">\n        <div class="loader"></div>\n        <li class="modal__movie-genre">Жанр - ${o.genres.map((e=>` <span>${e.genre}</span>`))}</li>\n        ${o.filmLength?`<li class="modal__movie-runtime">Время - ${o.filmLength} минут</li>`:""}\n        <li >Сайт: <a class="modal__movie-site" href="${o.webUrl}">${o.webUrl}</a></li>\n        <li ><a class="modal__movie-play" href="${n}"><p>Play</p></a></li>\n        <li class="modal__movie-overview">Описание - ${o.description}</li>\n      </ul>\n      <button type="button" class="modal__button-close">Закрыть</button>\n    </div>\n  `;document.querySelector(".modal__button-close").addEventListener("click",(()=>M()))}function M(){j.classList.remove("modal--show"),document.body.classList.remove("stop-scrolling")}window.addEventListener("click",(e=>{e.target===j&&M()})),window.addEventListener("keydown",(e=>{27===e.keyCode&&M()})),window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)})),document.querySelector(".icon-menu")&&document.addEventListener("click",(function(e){t&&e.target.closest(".icon-menu")&&(((e=500)=>{document.documentElement.classList.contains("lock")?o(e):n(e)})(),document.documentElement.classList.toggle("menu-open"))})),function(e={viewPass:!1}){const t=document.querySelectorAll("input[placeholder],textarea[placeholder]");t.length&&t.forEach((e=>{e.hasAttribute("data-placeholder-nohide")||(e.dataset.placeholder=e.placeholder)})),document.body.addEventListener("focusin",(function(e){const t=e.target;"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName||(t.dataset.placeholder&&(t.placeholder=""),t.hasAttribute("data-no-focus-classes")||(t.classList.add("_form-focus"),t.parentElement.classList.add("_form-focus")),i.removeError(t))})),document.body.addEventListener("focusout",(function(e){const t=e.target;"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName||(t.dataset.placeholder&&(t.placeholder=t.dataset.placeholder),t.hasAttribute("data-no-focus-classes")||(t.classList.remove("_form-focus"),t.parentElement.classList.remove("_form-focus")),t.hasAttribute("data-validate")&&i.validateInput(t))})),e.viewPass&&document.addEventListener("click",(function(e){let t=e.target;if(t.closest('[class*="__viewpass"]')){let e=t.classList.contains("_viewpass-active")?"password":"text";t.parentElement.querySelector("input").setAttribute("type",e),t.classList.toggle("_viewpass-active")}}))}({viewPass:!1})})();